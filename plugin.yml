# File generated by './pkg/schema/generator'. DO NOT EDIT.

name: Terraform Buildkite Plugin
description: |-
    A Buildkite plugin for processing a terraform working directory.
    Allowing you to perform operations such as plan & apply.
    With support for looping over multiple working directories,
    Open Policy Agent checks against plans &
    Buildkite annotations detailing the success or failure of the the operations.
author: https://github.com/xphir
requirements:
    - buildkite-agent
    - terraform
    - opa
configuration:
    additionalProperties: false
    properties:
        mode:
            description: Operation mode for the plugin (plan or apply)
            title: mode
            type: string
        outputs:
            description: A list of output adaptors
            items:
                additionalProperties: false
                properties:
                    buildkite_annotation:
                        additionalProperties: false
                        description: Buildkite pipeline annotation configuration
                        properties:
                            computed_vars:
                                description: Variables computed from Terraform output
                                items:
                                    additionalProperties: false
                                    properties:
                                        from:
                                            description: Source field to extract the variable from
                                            title: from
                                            type: string
                                        name:
                                            description: Name of the computed variable
                                            title: name
                                            type: string
                                        regex:
                                            description: Regular expression to extract the variable value
                                            title: regex
                                            type: string
                                    required:
                                        - name
                                        - from
                                        - regex
                                    type: object
                                title: computed_vars
                                type: array
                            context:
                                description: Context for the output formatting
                                title: context
                                type: string
                            template:
                                description: Template for formatting the output
                                title: template
                                type: string
                            vars:
                                description: Variables to be used in output formatting
                                items:
                                    additionalProperties:
                                        type: string
                                    type: object
                                title: vars
                                type: array
                        title: annotation
                        type: object
                type: object
            title: outputs
            type: array
        terraform:
            additionalProperties: false
            description: Terraform execution options including plugin directory
            properties:
                exec_path:
                    description: Path to the Terraform executable
                    title: exec_path
                    type: string
                init_options:
                    additionalProperties: false
                    description: Options for the terraform init command
                    properties:
                        get_plugins:
                            description: Whether to automatically download Terraform plugins
                            title: get_plugins
                            type: boolean
                        plugin_dir:
                            description: Directory containing Terraform plugins
                            title: plugin_dir
                            type: string
                    required:
                        - plugin_dir
                        - get_plugins
                    title: init
                    type: object
            title: terraform
            type: object
        validations:
            description: A list of validation adapters
            items:
                additionalProperties: false
                properties:
                    opa:
                        additionalProperties: false
                        description: OPA (Open Policy Agent) validation configuration
                        properties:
                            bundle:
                                description: OPA bundle path or URL for policy validation
                                title: bundle
                                type: string
                            condition:
                                description: The condition we evaluate to determine if the policy results pass or fail
                                title: condition
                                type: string
                            query:
                                description: OPA query to evaluate
                                title: query
                                type: string
                        required:
                            - bundle
                            - query
                        title: opa
                        type: object
                type: object
            title: validations
            type: array
        working:
            additionalProperties: false
            description: Configuration for the working directories containing Terraform configurations
            properties:
                directories:
                    additionalProperties: false
                    description: Configuration for multiple working directories
                    properties:
                        artifact:
                            description: Artifact path containing Terraform configurations
                            title: artifact
                            type: string
                        name_regex:
                            description: Regular expression to filter directory names
                            title: name_regex
                            type: string
                        parent_directory:
                            description: Parent directory containing Terraform configurations
                            title: parent_directory
                            type: string
                    title: directories
                    type: object
                directory:
                    description: Single working directory path
                    title: directory
                    type: string
            required:
                - directories
            title: working
            type: object
    required:
        - mode
        - working
    type: object
